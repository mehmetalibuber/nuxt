import{H as ze}from"./components.ad2c2230.js";import{i as Le,j as Oe,k as qe,r as n,y as _e,m as F,l as Fe,A as He,c as u,b as Be,w as je,a as e,F as A,L as E,g as o,h as Ke,o as c,t as a,U as Ye,M as m,$ as Xe,d as y,q as R,n as G,a4 as U,N as he,a5 as W,p as Je,e as Qe}from"./entry.9a02144e.js";import{u as fe}from"./cookie.e9d56610.js";import{D as We}from"./DestinationComposable.a4040b2e.js";import{H as Z}from"./axiosConfig.d247a524.js";import{R as ye}from"./ReservationComposable.2e0c03a4.js";import{A as ee}from"./AuthComposable.dc84fb17.js";import{_ as Ze}from"./404-not-found.847f5c3a.js";import{_ as et}from"./_plugin-vue_export-helper.c27b6911.js";import"./vue.f36acd1f.574b5528.js";const tt=""+globalThis.__publicAssetsURL("assets/icons/add.svg");const h=T=>(Je("data-v-73c38737"),T=T(),Qe(),T),st={class:"container"},lt={class:"progress-container container d-flex justify-content-center mt-4"},ot=["onClick"],at={class:""},nt={class:"payment-steps mt-4 mb-5"},it={key:0},ut={class:"row"},ct={class:"col-lg-8"},dt={class:"res-card"},rt={class:"row"},vt={class:"col-lg-3"},mt=["src","alt","title"],pt={key:1,src:Ze,alt:"not found",title:"not found",class:"img-thumbnail"},_t={class:"col-lg-9"},ht={class:"desc-top"},ft={class:"d-block"},yt={key:0,class:"square-meter"},bt={key:1,class:"square-meter"},Ct={class:"col"},kt={class:"row mt-4"},gt={class:"col-lg-12 guest-left"},Rt={class:"row"},wt={class:"guest-left-warning"},It={class:"row my-3"},St=["title"],Ut=h(()=>e("div",{class:"row"},[e("h2",null,"İletişim Bilgileri")],-1)),Dt={class:"row mt-2"},Mt={class:"col-lg-6"},$t={class:"form-group"},Nt={for:"email"},At=["placeholder"],Gt={class:"col-lg-6"},xt={class:"form-group"},Pt={for:"tel"},Et={class:"row phone-space"},Tt=h(()=>e("div",{class:"col-lg-2"},[e("select",{name:"",id:""},[e("option",{value:"+90",selected:""},"+90")])],-1)),Vt={class:"col-lg-10"},zt=["placeholder"],Lt=h(()=>e("div",{class:"row mt-2"},null,-1)),Ot={class:"col-lg-12 mt-3 pt-3 user-guests"},qt=h(()=>e("div",{class:"row"},[e("h2",null,"Misafir Bilgileri")],-1)),Ft={class:"row mt-1"},Ht={class:"row select-side mt-1"},Bt={key:0,class:"col-xl-5 col-lg-4 d-flex align-items-center"},jt={class:"w-100"},Kt=h(()=>e("option",{value:null,disabled:""}," Kayıtlı Misafirler ",-1)),Yt=["value","disabled"],Xt={class:"col-xl-4 col-lg-4 d-flex align-items-center"},Jt=h(()=>e("img",{src:tt,alt:"add"},null,-1)),Qt={class:"col-xl-3 col-lg-4 d-flex align-items-center"},Wt=h(()=>e("option",{value:null,disabled:""},"Çoklu Seçim",-1)),Zt=["value"],es={class:"row",id:"user-guests-input"},ts={class:"row"},ss={class:"col-xl-3 col-md-6"},ls=["onUpdate:modelValue","readonly"],os={class:"col-xl-3 col-md-6"},as=["onUpdate:modelValue","readonly"],ns={class:"col-xl-2 col-md-6"},is={class:"form-check form-switch"},us=["onUpdate:modelValue","id"],cs=["for"],ds={key:0,class:"col-xl-3 col-md-6"},rs=["onUpdate:modelValue"],vs={key:1,class:"col-xl-3 col-md-6"},ms=["onUpdate:modelValue"],ps=h(()=>e("div",{class:"my-1"},null,-1)),_s={class:"col-xl-6 col-md-6"},hs={class:"row"},fs={class:"col-10 col-md-6 d-flex align-items-center h-40"},ys={class:"row w-100"},bs={class:"col-8"},Cs=["for"],ks={class:"col-4"},gs={class:"form-check form-switch"},Rs=["id","onUpdate:modelValue"],ws={class:"col-2"},Is=["onClick"],Ss={class:"col-lg-4"},Us={class:"summary-section"},Ds={class:"check-in-box mt-2"},Ms={class:"row"},$s={class:"col"},Ns=h(()=>e("br",null,null,-1)),As={class:"col"},Gs=h(()=>e("br",null,null,-1)),xs={class:"col mt-3"},Ps=h(()=>e("div",{class:"mt-3"},null,-1)),Es={class:"col mt-3"},Ts={class:"summary-items"},Vs={class:"container"},zs={class:"row"},Ls={class:"col"},Os={class:"col"},qs={class:"row"},Fs={class:"col"},Hs={class:"col"},Bs={class:"row"},js={class:"col"},Ks={class:"col"},Ys={class:"row"},Xs={class:"col"},Js={class:"col"},Qs={class:"row mt-3 total-price"},Ws={class:"col"},Zs={class:"col old"},el={key:0,class:"col new"},tl=h(()=>e("hr",{style:{margin:"6px 0"}},null,-1)),sl={class:"row mt-1 coupons"},ll={class:"col-lg-12"},ol={class:"form-check"},al=["value"],nl={class:"form-check-label",for:"coupon"},il={key:0,class:"row mt-1 d-flex justify-content-around"},ul={class:"col-lg-8"},cl=["placeholder"],dl={class:"col-lg-4 d-flex align-items-end"},rl=["title"],vl={class:"col mt-3 text-center"},ml=["disabled"],pl={class:"mt-2"},_l={class:"text-danger err-side",style:{height:"20px"}},hl={key:0},fl={key:1,style:{display:"flex","justify-content":"center"}},yl=["src"],bl={__name:"index",setup(T){Le();const te=Oe(),be=Ke(),H=qe("EstateInfo"),B=fe("EstateID"),f=fe("Filters");let p=n({});const se=n(["ReservationInformations","Payment"]),Ce=n(["",""]),V=n(0),le=n(""),x=n(""),j=n(0),oe=n(""),ae=n(""),K=n(0),Y=n(2),ne=n(""),ie=n(""),D=n(""),C=n(""),w=n(!1),ue=n(null);n(""),n(""),n("");const X=n(null),P=n(0),ce=n(0),de=n(0),re=n(0),ve=n(0),i=n(""),I=n(""),b=n(!1),S=n(!1),M=n(!1),z=n(0),$=n(Number),L=n([]),ke=n(!0),ge=n([]),N=n(0),r=n([]),k=n(null),O=n(null),Re=()=>{J.value||(i.value='En az bir misafirin "Sorumlu Kişi" olarak eklenmesi gerekmektedir.')},J=_e(()=>r.value.some(t=>t.isResponsible)),we=async()=>{ge.value=[];const t=document.querySelectorAll("#user-guests-input input");let s=!0;if(t.forEach(d=>{d.value.trim()===""?(s=!1,d.classList.add("is-invalid")):d.classList.remove("is-invalid")}),!s)return i.value="Lütfen misafir bilgilerini eksiksiz girin.",!1;if(!J.value)return r.value.length==0?(i.value="En az bir misafir ekleyin.",!1):(i.value='En az bir misafirin "Sorumlu Kişi" olarak eklenmesi gerekmektedir.',!1)},me=_e(()=>L.value.filter(t=>!r.value.some(s=>s.id===t.id))),q=t=>{if(Q(N.value++)==!0){if(t=="isMe"){r.value.push({id:ue.value,name:ne.value,surname:ie.value,isResponsible:!0,idNumber:null,tcCitizen:!0,readOnly:!0});return}if(k.value){i.value="",r.value.push({id:k.value.id,name:k.value.name,surname:k.value.surname,isResponsible:!1,idNumber:null,tcCitizen:!0,readOnly:!1}),k.value=null,me.value=L.value.filter(d=>!r.value.some(v=>v.id===d.id));return}else{i.value="",r.value.push({id:Math.random(),name:null,surname:null,isResponsible:!1,idNumber:null,tcCitizen:!0,readOnly:!1});return}}else return Q(N.value--),w.value=!1,alert("Misafir kapasitesi aşıldı.")},Ie=()=>{q()},Se=t=>{r.value=r.value.filter(s=>s.id!==t),Q(N.value--),N.value==0&&w.value==!0&&(w.value=!1,J.value=!1)},Q=t=>!(N.value>$.value),Ue=t=>r.value.some(s=>s.id===t.id);F(O,t=>{r.value.length=0,N.value=0,w.value=!1;for(let s=0;s<t;s++)q()});const De=t=>{},Me=()=>{V.value<se.value.length-1&&V.value++};Fe(async()=>{const t=be.public.CRM_HOST;if(le.value=`${t}/files/IMAGE/`,H.value)p.value=H.value,$.value=H.value.numberOfPeople;else if(f.value){const s=await We().GetDestinationByID(B.value,f.value.Dates);p.value=s.data,$.value=s.data.numberOfPeople}else te.push("/error");p.value.media[0]&&(x.value=p.value.media[0]),j.value=Z().CalculateNights(f.value.Dates[0],f.value.Dates[1]),oe.value=f.value.Dates[0],ae.value=f.value.Dates[1],await Ae(),Te()}),He(()=>{window.removeEventListener("beforeunload",pe)});const pe=t=>{const s="Ödeme işleminiz tamamlanmadı. Sayfayı kapatmak veya yenilemek istediğinize emin misiniz?";return t.returnValue=s,s},$e=async()=>{if(i.value="",Z().CheckGuestEmailAddress(D.value)!=!0)return i.value="InvalidEmail";const s=Z().CheckGuestPhoneNumber(C.value);if(s=="1")return i.value="InvalidPhoneNumber";if(C.value=s,p.value.numberOfPeople&&parseInt(Y.value)+parseInt(K.value)>p.value.numberOfPeople)return i.value="TheNumberOfPeopleIsExceed";if(await we()!=!1){if(r.value.length==0)return i.value="En az 1 misafir ekleyin.";if(r.value.length>0&&r.value.length>$.value)return i.value="Misafir kapasitesi aşıldı.";await Ge()}},Ne=t=>{let s=t.target.value.replace(/\D/g,"");C.value=s},Ae=async()=>{if(f.value.Dates){const t=f.value.Dates[0],s=f.value.Dates[1],d=await ye().CheckAvailability(t,s);if(d)if(d.data){const v=d.data;P.value=Math.ceil(v.total*36.5533),de.value=v.cleaningFee,re.value=v.taxRate.taxAmount,ve.value=v.taxRate.taxRate,ce.value=v.totalAccommodationFee}else return te.push(`/destinations/${B.value}`),i.value=d}},Ge=async()=>{S.value=!0;const t={estateId:B.value,startDate:f.value.Dates[0],endDate:f.value.Dates[1],adultCount:Y.value,childCount:K.value,webSite:null,paymentType:null,isMe:w.value,identify:[],contact:{email:D.value,phone:C.value}};if(b.value==!0&&!I.value)return i.value="InvalidCouponCode";b.value==!0&&I.value&&(t.couponCode=I.value),r.value.length>0&&r.value.forEach(async d=>{let v=d.id.toString().length;t.identify.push({id:v<6?d.id:null,name:d.name,surname:d.surname,responsible:d.isResponsible,identityNumber:d.idNumber,idType:d.tcCitizen==!0?0:1})}),t.adultCount=t.identify.length;const s=await ye().SendReservationData(t);if(s){if(s.data)s.data.paymentURL&&(X.value=s.data.paymentURL);else return S.value=!1,s=="Error"?i.value="Sistemsel bir sorun oluştu.":i.value=s;s.data,S.value=!1,Me()}},xe=async()=>{if(b.value==!0){const t=await ee().CheckUserCoupon(I.value,P.value,j.value);if(t)if(t.data)if(t.data.discountAmount)document.querySelector("#selected-coupon").readOnly=!0,document.querySelector(".total-price .old").style.textDecoration="line-through",t.data.exchangeRateName.toUpperCase()=="TL"?z.value=P.value-t.data.discountAmount:z.value=P.value-Math.ceil(t.data.discountAmount*t.data.exchangeRateValue),M.value=!0,S.value=!1,i.value="";else return M.value=!1,document.querySelector(".total-price .old").style.textDecoration="none",i.value="InvalidCouponCode";else return M.value=!1,document.querySelector(".total-price .old").style.textDecoration="none",i.value="InvalidCouponCode"}else return document.querySelector(".total-price .old").style.textDecoration="none",M.value=!1,i.value="InvalidCouponCode"},Pe=async()=>{if(i.value="",w.value!=!0){const t=await ee().GetUserInformations();t&&(t.data?(ne.value=t.data.name,ie.value=t.data.surname,C.value=t.data.phone,D.value=t.data.email,ue.value=t.data.id,w.value=!0,await Ee(),q("isMe")):i.value="MemberInfoNotFound")}else i.value="Üyelik bilgileri zaten kullanıldı."},Ee=async()=>{document.querySelectorAll(".guest-left .form-control").forEach(function(s){setTimeout(()=>{s.value&&(s.readOnly=!0)})},500)},Te=async()=>{const t=await ee().GetUserGuests();t&&t.data&&t.data.identification&&(L.value=t.data.identification)};return F(()=>{Y.value,K.value,z.value,ke.value}),F(b,(t,s)=>{S.value=t==!0,M.value=!1,document.querySelector(".total-price .old").style.textDecoration="none"}),F(X,(t,s)=>{t&&(window.addEventListener("beforeunload",pe),S.value=!0)}),(t,s)=>{const d=ze;return c(),u(A,null,[Be(d,null,{default:je(()=>[e("title",null,a(t.$t("ReservationInformations")),1)]),_:1}),e("section",st,[e("div",lt,[(c(!0),u(A,null,E(o(se),(v,g)=>(c(),u("div",{key:g,class:Ye({step:!0,active:o(V)===g}),onClick:l=>De()},[e("div",at,a(g+1),1),e("div",null,a(t.$t(v)),1)],10,ot))),128))]),e("div",nt,[(c(!0),u(A,null,E(o(Ce),(v,g)=>m((c(),u("div",{key:g,class:"step-content"},[g===0?(c(),u("div",it,[e("div",ut,[e("div",ct,[e("div",dt,[e("div",rt,[e("div",vt,[e("figure",null,[o(x).url?(c(),u("img",{key:0,src:o(le)+o(x).url,alt:o(x).name,title:o(x).name,class:"img-thumbnail"},null,8,mt)):(c(),u("img",pt))])]),e("div",_t,[e("div",ht,[e("h2",null,a(o(p).name),1),e("div",ft,[o(p).squareMeters?(c(),u("span",yt,[y(a(t.$t("RoomSquareMeters"))+": ",1),e("b",null,a(o(p).squareMeters),1)])):R("",!0),y("   -   "),o(p).numberOfPeople?(c(),u("span",bt,[y(a(t.$t("MaxGuest"))+": ",1),e("b",null,a(o(p).numberOfPeople),1)])):R("",!0)]),e("div",Ct,[e("p",null,a(o(p).description),1)])])])])]),e("div",kt,[e("div",gt,[e("div",Rt,[e("small",wt," * Bu mülk için eklenebilir misafir sayısı "+a(o($))+" ve en az 1 sorumlu kişi seçilmelidir. ",1)]),e("div",null,[e("div",It,[e("span",{class:"opacity-75 text-decoration-underline",title:t.$t("UseMemberInformations"),onClick:s[0]||(s[0]=l=>Pe()),style:{cursor:"pointer"}},a(t.$t("UseMemberInformations")),9,St)]),e("form",null,[Ut,e("div",Dt,[e("div",Mt,[e("div",$t,[e("label",Nt,a(t.$t("EmailAddress"))+"(*)",1),m(e("input",{type:"email",class:"form-control",id:"email",required:"",placeholder:t.$t("EmailAddress"),"onUpdate:modelValue":s[1]||(s[1]=l=>G(D)?D.value=l:null)},null,8,At),[[U,o(D)]])])]),e("div",Gt,[e("div",xt,[e("label",Pt,a(t.$t("PhoneNumber"))+"(*)",1),e("div",Et,[Tt,e("div",Vt,[m(e("input",{type:"tel",class:"form-control",id:"tel",placeholder:t.$t("PhoneNumberMask"),required:"",maxlength:"10","onUpdate:modelValue":s[2]||(s[2]=l=>G(C)?C.value=l:null),onInput:Ne},null,40,zt),[[U,o(C)]])])])])])]),Lt])])])]),e("div",Ot,[qt,e("div",Ft,[e("div",Ht,[o(L).length>0?(c(),u("div",Bt,[e("div",jt,[m(e("select",{"onUpdate:modelValue":s[3]||(s[3]=l=>G(k)?k.value=l:null),class:"form-select",onChange:s[4]||(s[4]=l=>Ie())},[Kt,(c(!0),u(A,null,E(o(me),l=>(c(),u("option",{key:l.id,value:l,disabled:Ue(l)},a(l.name)+" "+a(l.surname),9,Yt))),128))],544),[[he,o(k)]])])])):R("",!0),e("div",Xt,[e("button",{type:"button",class:"btn",onClick:s[5]||(s[5]=l=>q()),title:"Yeni misafir ekle"},[y(" Yeni Misafir Ekle "),Jt])]),e("div",Qt,[m(e("select",{"onUpdate:modelValue":s[6]||(s[6]=l=>G(O)?O.value=l:null)},[Wt,(c(!0),u(A,null,E(o($),l=>(c(),u("option",{key:l,value:l},a(l),9,Zt))),128))],512),[[he,o(O)]])])]),e("div",es,[(c(!0),u(A,null,E(o(r),(l,Ve)=>(c(),u("div",{key:l.id,class:"row mt-4 user-box"},[e("div",ts,[e("h2",null,a(Ve+1)+". Misafir",1)]),e("div",ss,[m(e("input",{type:"text",class:"form-control h-40",name:"name","onUpdate:modelValue":_=>l.name=_,placeholder:"Ad",readonly:l.readOnly,title:"Misafir ad"},null,8,ls),[[U,l.name]])]),e("div",os,[m(e("input",{type:"text",class:"form-control h-40",name:"surname","onUpdate:modelValue":_=>l.surname=_,placeholder:"Soyad",readonly:l.readOnly,title:"Misafir soyad"},null,8,as),[[U,l.surname]])]),e("div",ns,[e("div",is,[m(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":_=>l.tcCitizen=_,id:"guest-tcCitizen-"+l.id,title:"Uyruk"},null,8,us),[[W,l.tcCitizen]]),e("label",{for:"guest-tcCitizen-"+l.id,class:"opacity-50"}," TC Vatandaşı ",8,cs)])]),l.tcCitizen?(c(),u("div",ds,[m(e("input",{type:"text",class:"form-control h-40",name:"tc","onUpdate:modelValue":_=>l.idNumber=_,placeholder:"TC Kimlik Numarası",title:"TC kimlik numarası"},null,8,rs),[[U,l.idNumber]])])):(c(),u("div",vs,[m(e("input",{type:"text",class:"form-control h-40",name:"passport","onUpdate:modelValue":_=>l.idNumber=_,placeholder:"Pasaport Numarası",title:"Pasaport numarası"},null,8,ms),[[U,l.idNumber]])])),ps,e("div",_s,[e("div",hs,[e("div",fs,[e("div",ys,[e("div",bs,[e("label",{for:"guest-responsible-"+l.id,class:"opacity-50"},"Sorumlu Kişi",8,Cs)]),e("div",ks,[e("div",gs,[m(e("input",{class:"form-check-input",type:"checkbox",name:"responsible",id:"guest-responsible-"+l.id,"onUpdate:modelValue":_=>l.isResponsible=_,onChange:Re,title:"Sorumlu kişi"},null,40,Rs),[[W,l.isResponsible]])])])])]),e("div",ws,[e("button",{class:"btn h-40 del-btn",onClick:_=>Se(l.id),style:{width:"min-content"},title:"Sil"}," X ",8,Is)])])])]))),128))])])])]),e("div",Ss,[e("div",Us,[e("span",null,[e("b",null,a(t.$t("ReservationSummary")),1)]),e("div",Ds,[e("div",Ms,[e("div",$s,[y(a(t.$t("CheckIn"))+": ",1),Ns,y(" "+a(o(oe)),1)]),e("div",As,[y(a(t.$t("CheckOut"))+": ",1),Gs,y(" "+a(o(ae)),1)])]),e("div",xs,[e("div",null,[e("span",null,[y(a(t.$t("TotalLengthOfStay"))+": ",1),e("b",null,a(o(j)),1),y(" "+a(t.$t("Night")),1)])]),Ps])]),e("div",Es,[e("div",Ts,[e("div",Vs,[e("div",zs,[e("div",Ls,[e("span",null,a(t.$t("AccommodationFee"))+":",1)]),e("div",Os,[e("span",null,a(Math.ceil(o(ce)*36.5533).toLocaleString("tr-TR"))+"   ₺",1)])]),e("div",qs,[e("div",Fs,[e("span",null,a(t.$t("TaxRate"))+":",1)]),e("div",Hs,[e("span",null,a(o(ve))+"  %",1)])]),e("div",Bs,[e("div",js,[e("span",null,a(t.$t("TaxAmount"))+":",1)]),e("div",Ks,[e("span",null,a(Math.ceil(o(re)*36.5533).toLocaleString("tr-TR"))+"   ₺",1)])]),e("div",Ys,[e("div",Xs,[e("span",null,a(t.$t("CleaningFee"))+":",1)]),e("div",Js,[e("span",null,a(Math.ceil(o(de)*36.5533).toLocaleString("tr-TR"))+"  ₺",1)])]),e("div",Qs,[e("div",Ws,a(t.$t("Total"))+" "+a(t.$t("Price"))+": ",1),e("div",Zs,a(o(P).toLocaleString("tr-TR"))+"   ₺ ",1),o(M)?(c(),u("div",el,a(o(z).toLocaleString("tr-TR"))+"   ₺ ",1)):R("",!0)]),tl,e("div",sl,[e("div",ll,[e("div",ol,[m(e("input",{class:"form-check-input",type:"checkbox",name:"coupon",value:o(b),"onUpdate:modelValue":s[7]||(s[7]=l=>G(b)?b.value=l:null),id:"coupon"},null,8,al),[[W,o(b)]]),e("label",nl,a(t.$t("UseCouponCode")),1)])]),o(b)?(c(),u("div",il,[e("div",ul,[m(e("input",{type:"text","onUpdate:modelValue":s[8]||(s[8]=l=>G(I)?I.value=l:null),placeholder:t.$t("EnterCouponCode"),id:"selected-coupon"},null,8,cl),[[U,o(I)]])]),e("div",dl,[e("span",{class:"code-apply",onClick:s[9]||(s[9]=l=>xe()),title:t.$t("Apply")},a(t.$t("Apply")),9,rl)])])):R("",!0)])])])]),e("div",vl,[e("button",{class:"btn payment-btn",onClick:s[10]||(s[10]=l=>$e()),disabled:o(S)},a(t.$t("ContinuePaymentStep")),9,ml)])]),e("div",pl,[e("div",_l,[o(i)?(c(),u("p",hl,"* "+a(t.$t(o(i))),1)):R("",!0)])])])])])):R("",!0),g===1?(c(),u("div",fl,[e("iframe",{src:o(X),frameborder:"0",style:{},id:"payment-iframe",onLoad:s[11]||(s[11]=(...l)=>t.HideIframeContent&&t.HideIframeContent(...l))},null,40,yl)])):R("",!0)])),[[Xe,o(V)===g]])),128))])])],64)}}},$l=et(bl,[["__scopeId","data-v-73c38737"]]);export{$l as default};
