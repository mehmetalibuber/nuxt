{"version":3,"file":"auth-35ed28d4.js","sources":["../../../../middleware/auth.ts"],"sourcesContent":["export default defineNuxtRouteMiddleware(async (to, from) => {\r\n  const Router = useRouter(); // router\r\n  const User = useCookie(\"User\"); // cookie user\r\n  const Localization = useCookie(\"i18n_redirected\"); // localization\r\n\r\n  // retun if login or register pages\r\n  if (to.fullPath.includes(\"/login\") || to.fullPath.includes(\"/register\")) {\r\n    return;\r\n  }\r\n\r\n  // access token expire control\r\n  const AccessTokesExpiredControl = async () => {\r\n    try {\r\n      const UserData = await AuthComposable().GetUserInformations();\r\n      if (UserData == \"Access Denied\") {\r\n        await SignOut();\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Error during token expiry control:\", error);\r\n    }\r\n  };\r\n\r\n  // sign out\r\n  const SignOut = async () => {\r\n    try {\r\n      if (process.client) {\r\n        localStorage.removeItem(\"AccessToken\");\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Error removing access token from localStorage:\", error);\r\n    }\r\n    User.value = null;\r\n    await Router.push(\"/user/login\");\r\n  };\r\n\r\n  // redirect login page\r\n  if (!User.value) {\r\n    try {\r\n      const redirectPath =\r\n        Localization.value && Localization.value.toString() !== \"tr\"\r\n          ? `/${Localization.value.toString()}/user/login`\r\n          : \"/user/login\";\r\n\r\n      // save redirect path\r\n      if (process.client) {\r\n        localStorage.setItem(\"RedirectAfterLogin\", to.fullPath);\r\n      }\r\n      return Router.push(redirectPath);\r\n    } catch (error) {\r\n      console.error(\"Error during redirection:\", error);\r\n    }\r\n  }\r\n\r\n  await AccessTokesExpiredControl();\r\n});\r\n"],"names":["__executeAsync"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;AACE,MAAA,OAAyB,0CAAA,OAAA,IAAA,SAAA;AAAA,MAAA,QAAA;AACnB,QAAA,SAAO;AACP,QAAA,OAAA,UAAe,MAAA;AAGjB,QAAA,eAAY,UAAS,iBAAgB;AACvC,MAAA,GAAA,SAAA,SAAA,QAAA,KAAA,GAAA,SAAA,SAAA,WAAA,GAAA;AACF;AAAA,EAGA;AACM,QAAA,4BAAA,YAAA;AACF,QAAA;AACA,uBAAiC,MAAA,eAAA,EAAA,oBAAA;AAC/B,UAAA,YAAc,iBAAA;AAChB,cAAA,QAAA;AAAA;IAEQ,SAAA,OAAM;AAChB,cAAA,MAAA,sCAAA,KAAA;AAAA,IACF;AAAA,EAGA;AACM,QAAA,UAAA,YAAA;AACF,QAAA;AACE,UAAA;AAAA;AAAA,IAGM,SAAA,OAAM;AAChB,cAAA,MAAA,kDAAA,KAAA;AAAA,IACA;AACM,SAAA,QAAO;AACf,UAAA,OAAA,KAAA,aAAA;AAAA,EAGA;AACM,MAAA,CAAA,KAAA,OAAA;AACF,QAAA;AAMA,YAAI,eAAgB,aAAA,SAAA,aAAA,MAAA,eAAA,OAAA,IAAA,aAAA,MAAA,SAAA,CAAA,gBAAA;AACL;;aAGR,OAAO,KAAA,YAAA;AAAA,IACN,SAAA,OAAM;AAChB,cAAA,MAAA,6BAAA,KAAA;AAAA,IACF;AAAA,EAEM;AACP,EAAA,CAAA,QAAA,SAAA,IAAAA,aAAA,MAAA,0BAAA,CAAA,GAAA,MAAA,QAAA,UAAA;;"}